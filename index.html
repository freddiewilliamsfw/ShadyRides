/**
 * Calculates the bearing between two points given their easting and northing coordinates.
 * @param {number} easting1 - Easting of the first point
 * @param {number} northing1 - Northing of the first point
 * @param {number} easting2 - Easting of the second point
 * @param {number} northing2 - Northing of the second point
 * @return {number} Bearing in degrees (0-360)
 * @customfunction
 */
function calculateBearing(easting1, northing1, easting2, northing2) {
  // Calculate differences in coordinates
  const deltaE = easting2 - easting1;
  const deltaN = northing2 - northing1;
  
  // Calculate bearing
  let bearing = Math.atan2(deltaE, deltaN) * 180 / Math.PI;
  
  // Normalize to 0-360 degrees
  bearing = (bearing + 360) % 360;
  
  return bearing;
}

/**
 * Provides a cardinal direction based on the bearing.
 * @param {number} bearing - Bearing in degrees
 * @return {string} Cardinal direction
 * @customfunction
 */
function getCardinalDirection(bearing) {
  const directions = ['N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW'];
  return directions[Math.round(bearing / 45) % 8];
}

/**
 * Calculates the bearing and provides a description between two points.
 * @param {number} easting1 - Easting of the first point
 * @param {number} northing1 - Northing of the first point
 * @param {number} easting2 - Easting of the second point
 * @param {number} northing2 - Northing of the second point
 * @return {string} Description of the bearing
 * @customfunction
 */
function describeBearing(easting1, northing1, easting2, northing2) {
  const bearing = calculateBearing(easting1, northing1, easting2, northing2);
  const direction = getCardinalDirection(bearing);
  return `Bearing: ${bearing.toFixed(2)}Â° (${direction})`;
}
